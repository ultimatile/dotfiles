keybinding:
  universal:
    copyToClipboard: y
customCommands:
  - key: "J"
    prompts:
      - type: "menuFromCommand"
        title: "PRを選択:"
        key: "PRNumber"
        command: "gh pr list -d=false"
        filter: "^(?P<number>\\d+)\\t(?P<title>[^\\t]*)\\t"
        valueFormat: '{{ .number }} "{{ .title }}"'
        labelFormat: "#{{ .number }} {{ .title | green }}"
      - type: "menu"
        title: "チェックアウト方法を選択:"
        key: "CheckoutType"
        options:
          - name: "通常チェックアウト"
            description: "gh pr checkoutでブランチとしてチェックアウト"
            value: "通常チェックアウト"
          - name: "追跡ブランチ付きワークツリー"
            description: "ワークツリーとして追跡ブランチ付きでチェックアウト"
            value: "追跡ブランチ付きワークツリーでチェックアウト"
          - name: "デタッチドワークツリー"
            description: "ワークツリーとしてデタッチドHEADでチェックアウト"
            value: "デタッチドワークツリーでチェックアウト"
      - type: "confirm"
        title: "実行確認"
        body: "PR #{{.Form.PRNumber}}を{{.Form.CheckoutType}}しますか？"
    command: "$HOME/dotfiles/lazygit/pr-checkout-with-confirm.sh {{.Form.PRNumber | quote}} {{.Form.CheckoutType | quote}}"
    context: "global"
    loadingText: "PRをチェックアウト中"
    description: "PRをメニューから選択してチェックアウト"
    output: log
  - key: "K"
    prompts:
      - type: "input"
        title: "PR番号を入力:"
        key: "PRNumber"
      - type: "menu"
        title: "チェックアウト方法を選択:"
        key: "CheckoutType"
        options:
          - name: "通常チェックアウト"
            description: "gh pr checkoutでブランチとしてチェックアウト"
            value: "通常チェックアウト"
          - name: "追跡ブランチ付きワークツリー"
            description: "ワークツリーとして追跡ブランチ付きでチェックアウト"
            value: "追跡ブランチ付きワークツリーでチェックアウト"
          - name: "デタッチドワークツリー"
            description: "ワークツリーとしてデタッチドHEADでチェックアウト"
            value: "デタッチドワークツリーでチェックアウト"
      - type: "confirm"
        title: "実行確認"
        body: "PR #{{.Form.PRNumber}}を{{.Form.CheckoutType}}しますか？"
    command: "$HOME/dotfiles/lazygit/pr-checkout-with-confirm.sh {{.Form.PRNumber | quote}} {{.Form.CheckoutType | quote}}"
    context: "global"
    loadingText: "PRをチェックアウト中"
    description: "PR番号を指定してチェックアウト"
    output: log
  - key: "Y"
    #TODO: currently once "gh repo set-default owner/repo" command is necessary. To be fixed.
    command: "gh repo sync"
    context: "localBranches"
    loadingText: "syncing upstream branch"
    description: "フォークをupstreamに同期"
  - key: "Y"
    context: "commits"
    command: "printf {{.SelectedCommit.Hash}} | head -c7 | pbcopy"
    description: "ショートコミットハッシュをクリップボードにコピー"
  - key: "W"
    command: "$HOME/dotfiles/lazygit/remote-checkout-as-worktree.sh {{.SelectedRemoteBranch.RemoteName}} {{.SelectedRemoteBranch.Name}}"
    context: "remoteBranches"
    loadingText: "checking out remote branch as worktree"
    output: log
  - key: "U"
    command: "$HOME/dotfiles/lazygit/set-upstream-url.sh"
    description: "親レポジトリをリモートupstreamに設定"
    context: "global"
    loadingText: "adding upstream repository URL"
    output: log
  - key: "<c-g>"
    context: "global"
    description: "Pull Rebase戦略を設定"
    prompts:
      - type: "menu"
        title: "Pull Rebase戦略を選択:"
        key: "RebaseStrategy"
        options:
          - name: "merge (default)"
            description: "pull.rebase false - マージコミットを作成"
            value: "false"
          - name: "rebase"
            description: "pull.rebase true - リベースする"
            value: "true"
          - name: "rebase (preserve merges)"
            description: "pull.rebase merges - マージコミットを保持してリベース"
            value: "merges"
      - type: "confirm"
        title: "実行確認"
        body: "pull.rebase {{.Form.RebaseStrategy}} に設定しますか？"
    command: |
      git config pull.rebase {{.Form.RebaseStrategy}}
      echo "✓ pull.rebase {{.Form.RebaseStrategy}} に設定しました"
    loadingText: "Pull Rebase戦略を設定中"
    output: log
  - key: "<c-n>"
    context: "global"
    description: "Pull Fast-forward戦略を設定"
    prompts:
      - type: "menu"
        title: "Pull Fast-forward戦略を選択:"
        key: "FFStrategy"
        options:
          - name: "allow fast-forward (default)"
            description: "pull.ff true - fast-forward可能ならfast-forward"
            value: "true"
          - name: "fast-forward only"
            description: "pull.ff only - fast-forwardのみ許可"
            value: "only"
          - name: "always merge commit"
            description: "pull.ff false - 常にマージコミットを作成"
            value: "false"
      - type: "confirm"
        title: "実行確認"
        body: "pull.ff {{.Form.FFStrategy}} に設定しますか？"
    command: |
      git config pull.ff {{.Form.FFStrategy}}
      echo "✓ pull.ff {{.Form.FFStrategy}} に設定しました"
    loadingText: "Pull Fast-forward戦略を設定中"
    output: log
